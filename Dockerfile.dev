# =============================================================================
# DEVELOPMENT DOCKERFILE FOR LOCAL TESTING
# =============================================================================
# This Dockerfile is for LOCAL DEVELOPMENT ONLY (docker-compose).
# For AWS Lambda deployment, use the main Dockerfile.
#
# Key Differences from Production Dockerfile:
# - Uses standard Python image (not Lambda runtime)
# - Runs with uvicorn for hot-reload
# - Includes development tools
# - Smaller, faster builds for local iteration

FROM python:3.11-slim

# Set working directory
WORKDIR /app

# Set environment variables
ENV PYTHONUNBUFFERED=1 \
    PYTHONDONTWRITEBYTECODE=1 \
    PIP_NO_CACHE_DIR=1 \
    PIP_DISABLE_PIP_VERSION_CHECK=1

# Install system dependencies
RUN apt-get update && apt-get install -y \
    curl \
    && rm -rf /var/lib/apt/lists/*

# Copy requirements and install Python dependencies
COPY requirements.txt .
RUN pip install --no-cache-dir -r requirements.txt

# Install uvicorn with standard extras for development
RUN pip install --no-cache-dir "uvicorn[standard]==0.27.0"

# Copy application code
COPY ./app /app/app

# Expose port 8000
EXPOSE 8000

# Default command: Run with uvicorn for hot-reload
# This will be overridden by docker-compose.yml if specified there
CMD ["uvicorn", "app.lambda_api_handler:app", "--host", "0.0.0.0", "--port", "8000", "--reload"]
